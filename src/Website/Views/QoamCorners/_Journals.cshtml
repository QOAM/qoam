@using PagedList.Mvc
@using QOAM.Core
@using QOAM.Website.Helpers
@model QOAM.Website.ViewModels.QoamCorners.CornersIndexViewModel

<div class="row">
    <div class="col-md-4">
        <h3>@Model.CornerName</h3>
    </div>
    <div class="col-md-8 text-right" style="margin-top: 25px;">
        @if (Model.CornerAdmin != null)
        {
            if (Model.IsCornerAdmin)
            {
                @Html.ActionLink("Discontinue this corner", "DeleteCorner", new { id = Model.Corner }, new { id = "discard-corner", @class = "btn btn-danger"})
            }
            else {
                <em class="corner-admin-name">
                    <span>For updating this corner please contact the cornerAdmin </span>
                    @Html.ActionLink(Model.CornerAdmin.DisplayName, "Details", "Profiles", new { id = Model.CornerAdmin.Id }, null)
                </em>
            }

        }
    </div>
</div>
<div class="row">
    <div class="col-md-9">
        <h3>@Model.Journals.TotalItemCount journals; <a id="open-access-filter" href="#">full OA journals;</a> <a id="institutional-discount-filter" href="#">discounted journals</a></h3>
    </div>
    <div class="col-md-3 text-right topmargin">
        <div class="topmargin">@Sorting.JournalSortMenu(Model.SortBy, Model.Sort)</div>
    </div>
</div>

@{ const string title = "Italicized titles indicate institutional discounts.\nPlease click the tab 'Price information' on the detail page of the journal to find out more."; }

<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th class="title">
                Title
            </th>
            <th class="publisher">Publisher</th>
            <th><a class="help-window" href="@Url.Action("JournalScoreCard", "Home")#valuationjournalscorecard">Average score</a></th>
            <th>Scored by</th>
            <th class="swot">
                <a href="@Url.Action("JournalScoreCard", "Home")#swot">Submit</a>&nbsp;&nbsp;
                <a href="/tools#submission" title="Including a submission button in QOAM" target="_blank">
                    <span class="glyphicon glyphicon-info-sign"></span>
                </a>
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var journal in Model.Journals)
        {
            <tr>
                <td>@Html.ActionLink(journal.Title, "Details", "Journals", new { id = journal.Id, returnUrl = Request.RawUrl }, null)</td>
                <td>@Html.ActionLink(journal.Publisher.Name, "Index", "Journals", new { Publisher = journal.Publisher.Name }, null)</td>
                <td class="text-center">@Scores.AverageScore(journal.ValuationScore, Model.SortBy)</td>
                <td class="text-center">
                    @if (journal.NumberOfValuationReviewers > 100) {
                        <span>100</span>
                        <a href="#" title="Max 100 most recent scores">
                            <span class="glyphicon glyphicon-info-sign"></span>
                        </a>
                    } else {
                        @(journal.NumberOfValuationReviewers)
                    }
                </td>
                @*<td class="verdict-@journal.Swot">*@
                <td class="verdict-strong">
                    @if (!string.IsNullOrWhiteSpace(journal.SubmissionPageLink))
                    {
                        <a href="@journal.SubmissionPageLink" alt="Go to submission page" title="Go to submission page" class="submission-link" target="_blank">S</a>
                    }
                    else
                    {
                        @:&#160;
                    }
                </td>
            </tr>
        }

    </tbody>
</table>
@Html.PagedListPager(Model.Journals, page => Url.Action("Index", Model.ToRouteValueDictionary(page)), Html.PagedListRenderOptions())


@Html.Partial("_DiscardCornerModal")