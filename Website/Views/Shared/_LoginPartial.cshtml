@if (User.Identity.IsAuthenticated && ViewBag.User != null)
{
    <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="@Url.Action("Details", "Profiles", new { id = ViewBag.User.Id })">@ViewBag.User.DisplayName <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li>@Html.ActionLink("Profile", "Details", "Profiles", new { id = ViewBag.User.Id }, null)</li>
            <li>@Html.ActionLink("Change password", "ChangePassword", "Account")</li>
            <li class="divider"></li>
            <li>
                @Html.ActionLink("Log off", "Logout", "Account")
            </li>
        </ul>
    </li>
}
else
{
    <li>@Html.ActionLink("Log in", "Login", "Account")</li>
    <li>@Html.ActionLink("Register", "Register", "Account")</li>
}